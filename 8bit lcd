#include <lpc214x.h>
#include <string.h>

#define RS (1 << 16)
#define EN (1 << 17)

// LCD data lines D0–D7 → P0.18–P0.25
#define DATA (0xFF << 18)  // bits 18–25 used for D0–D7

void delay(int ms) {
    int i, j;
    for (i = 0; i < ms; i++)
        for (j = 0; j < 1000; j++);
}

void lcd_cmd(unsigned char cmd) {
    IO0CLR = RS;          // RS = 0 for command
    IO0CLR = DATA;        // Clear data lines
    IO0SET = (cmd << 18); // Send full 8-bit command
    IO0SET = EN;
    delay(2);
    IO0CLR = EN;
}

void lcd_data(unsigned char data) {
    IO0SET = RS;          // RS = 1 for data
    IO0CLR = DATA;
    IO0SET = (data << 18); // Send full 8-bit data
    IO0SET = EN;
    delay(2);
    IO0CLR = EN;
}

void lcd_init() {
    IO0DIR |= RS | EN | DATA; // All pins as output

    delay(20);     // Power-on delay
    lcd_cmd(0x38); // Function Set: 8-bit, 2 lines, 5x7 font
    lcd_cmd(0x0C); // Display ON, Cursor OFF
    lcd_cmd(0x06); // Entry mode set: Increment cursor
    lcd_cmd(0x01); // Clear display
    delay(2);
}

void lcd_string(char *str) {
    while (*str)
        lcd_data(*str++);
}

int main() {
    lcd_init();
    lcd_string("VSPRIME");
    lcd_cmd(0xC0); // Move to 2nd line
    lcd_string("WELCOME");

    while (1);
}
